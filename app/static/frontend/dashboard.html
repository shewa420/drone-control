<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель управління дроном</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="navbar">
        <a href="/dashboard.html">Панель</a>
        <a href="/admin.html">Адмінка</a>
        <a href="/index.html">Вихід</a>
    </div>

    <h1>Управління дроном</h1>

    <div class="stick-container">
        <div class="stick">
            <h3>CH1 (Aileron)</h3>
            <div class="bar" id="ch1-bar"></div>
        </div>
        <div class="stick">
            <h3>CH2 (Elevator)</h3>
            <div class="bar" id="ch2-bar"></div>
        </div>
        <div class="stick">
            <h3>CH4 (Rudder)</h3>
            <div class="bar" id="ch4-bar"></div>
        </div>
        <div class="stick">
            <h3>CH3 (Throttle)</h3>
            <div class="bar" id="ch3-bar"></div>
        </div>
    </div>

    <table class="channels-table">
        <tr>
            <th>CH5</th>
            <th>CH6</th>
            <th>CH7</th>
            <th>CH8</th>
        </tr>
        <tr>
            <td id="ch5-val">0%</td>
            <td id="ch6-val">0%</td>
            <td id="ch7-val">0%</td>
            <td id="ch8-val">0%</td>
        </tr>
    </table>

    <script>
        window.addEventListener("gamepadconnected", () => {
            const interval = setInterval(() => {
                const gamepad = navigator.getGamepads()[0];
                if (!gamepad) return;

                const axes = gamepad.axes;

                // CH1 (Aileron)
                document.getElementById("ch1-bar").style.width = ((axes[0] + 1) / 2 * 100).toFixed(0) + "%";

                // CH2 (Elevator)
                document.getElementById("ch2-bar").style.width = ((-axes[1] + 1) / 2 * 100).toFixed(0) + "%";

                // CH4 (Rudder) — инвертирован
                document.getElementById("ch4-bar").style.width = ((-axes[2] + 1) / 2 * 100).toFixed(0) + "%";

                // CH3 (Throttle)
                document.getElementById("ch3-bar").style.width = ((axes[3] + 1) / 2 * 100).toFixed(0) + "%";

                // CH5 - CH8 текстовый вывод
                for (let i = 4; i <= 7; i++) {
                    let val = ((gamepad.axes[i] + 1) / 2 * 100).toFixed(0) + "%";
                    document.getElementById(`ch${i + 1}-val`).innerText = val;
                }

            }, 100);
        });
    </script>
</body>
</html>
